////////////////////////////////////////////////////////////////////////////
//	Created		: 26.11.2023
//	Author		: Deathman
//  Nocturning studio for NS Project X
////////////////////////////////////////////////////////////////////////////
#ifndef AMBIENT_LIGHT_HELPER_INCLUDED
#define AMBIENT_LIGHT_HELPER_INCLUDED
////////////////////////////////////////////////////////////////////////////
#include "common.h"
////////////////////////////////////////////////////////////////////////////
#define LIGHTMAP_BRIGHTNESS 1.25h
////////////////////////////////////////////////////////////////////////////
float3 CalculateAmbient(float LightMapAO, float3 Normal)
{
    float3 WorldSpaceNormal = mul(m_v2w, Normal);
    float3 EnvironmentActual = texCUBElod(env_s0, float4(WorldSpaceNormal, 4));
	float3 EnvironmentNext = texCUBElod(env_s1, float4(WorldSpaceNormal, 4));
    float3 Environment = lerp(EnvironmentActual, EnvironmentNext, env_color.w);
    return env_color.rgb * Environment * LightMapAO * LIGHTMAP_BRIGHTNESS + L_ambient.rgb;
}
////////////////////////////////////////////////////////////////////////////
#endif // AMBIENT_LIGHT_HELPER_INCLUDED
////////////////////////////////////////////////////////////////////////////
