//////////////////////////////////////////////////////////////////////////////////////////
#include "common.h"
//////////////////////////////////////////////////////////////////////////////////////////
struct Interpolators
{
    float4 HomogeniousPosition: POSITION;
    float4 Color: COLOR0;
    float3 UV0: TEXCOORD0;
    float3 UV1: TEXCOORD1;
};
//////////////////////////////////////////////////////////////////////////////////////////
uniform_samplerCUBE(s_sky0, smp_base);
uniform_samplerCUBE(s_sky1, smp_base);
//////////////////////////////////////////////////////////////////////////////////////////
// Pixel
float4 main (Interpolators Input): COLOR0
{
    float3 SkyActual = texCUBE (s_sky0, Input.UV0);
    float3 SkyNext = texCUBE (s_sky1, Input.UV1);
    float3 Sky = lerp (SkyActual, SkyNext, Input.Color.w);
    Sky = lerp (Sky, fog_color.rgb, fog_sky_influence);
    
    Sky = CalcTonemap (Sky);
    
    return float4 (Sky, 1.0f);
}
//////////////////////////////////////////////////////////////////////////////////////////