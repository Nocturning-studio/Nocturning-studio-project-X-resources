//////////////////////////////////////////////////////////////////////////////////////////
//	Created		: 08.12.2024
//	Author		: Deathman
//	NSProjectX Nocturning Studio - 2024
//////////////////////////////////////////////////////////////////////////////////////////
#include "common.xrh"
//////////////////////////////////////////////////////////////////////////////////////////
uniform float4 hdr_params;
//////////////////////////////////////////////////////////////////////////////////////////
float4 main(float2 TexCoords : TEXCOORD0) : COLOR
{
    float4 ImageColor = tex2Dlod0(s_image, TexCoords);
    
    //Gamma correction
    ImageColor.rgb = pow(ImageColor.rgb, hdr_params.y);
    
    //Brightness correction
    ImageColor.rgb *= hdr_params.z * 2.0f;
    
    //Tonemapping
    ImageColor.rgb = LumaWeightedReinhard(ImageColor.rgb);
    
    //Linear to REC.709 convertation
    ImageColor.rgb = OETF_REC709(ImageColor.rgb);
    
    return ImageColor;
}
//////////////////////////////////////////////////////////////////////////////////////////
