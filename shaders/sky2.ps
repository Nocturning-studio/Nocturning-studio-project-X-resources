//////////////////////////////////////////////////////////////////////////////////////////
#include "common.xrh"
//////////////////////////////////////////////////////////////////////////////////////////
struct Interpolators
{
    float4 HomogeniousPosition: POSITION;
    float4 Color: COLOR0;
    float3 UV: TEXCOORD0;
};
//////////////////////////////////////////////////////////////////////////////////////////
uniform samplerCUBE s_sky0;
uniform samplerCUBE s_sky1;
//////////////////////////////////////////////////////////////////////////////////////////
float4 main(Interpolators Input): COLOR0
{
    float3 SkyActual = texCUBE (s_sky0, Input.UV).rgb;
    float3 SkyNext = texCUBE(s_sky1, Input.UV).rgb;
    float3 Sky = lerp (SkyActual, SkyNext, Input.Color.w);

    Sky = lerp(Sky, fog_color.rgb, fog_sky_influence);
    
    return float4(Sky, 1.0f);
}
//////////////////////////////////////////////////////////////////////////////////////////